<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Code Quality Report</title>
    <meta name="description" content="Code Quality Report">
    <meta name="author" content="Quality Tooling Team">

    <!-- CSS only -->
    <link href="/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/resources/bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/resources/prism/prism.css" rel="stylesheet" type="text/css"/>
</head>

<body>
<script src="/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/resources/bootstrap/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/resources/prism/prism.js"></script>

<div class="container">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/root.html>root</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/src.html>src</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/main.html>main</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/java.html>java</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/com.html>com</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/mercadolibre/mercadolibre.html>mercadolibre</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/mercadolibre/shipping_cart_partial_cancel/shipping_cart_partial_cancel.html>shipping_cart_partial_cancel</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/mercadolibre/shipping_cart_partial_cancel/services/services.html>services</a></li>
                    <li class="breadcrumb-item active" aria-current="page"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/mercadolibre/shipping_cart_partial_cancel/services/providers/providers.html>providers</a></li>
        </ol>
    </nav>
</div>

<div class="container">
    <h2>RestService.java</h2>
    <span class="badge bg-warning text-dark">Total issues: 73</span>
    <span class="badge bg-warning text-dark">Complexity: 17</span>
    <hr>
</div>

<div class="container">
    <pre class="language-java line-numbers">
            <code>package com.mercadolibre.shipping_cart_partial_cancel.services.providers;</code>
                    <span class="badge bg-warning text-dark">Package name 'com.mercadolibre.shipping_cart_partial_cancel.services.providers' must match pattern '^[a-z]+(\.[a-z][a-z0-9]*)*$'.</span>
            <code> </code>
            <code>import static com.mercadolibre.shipping_cart_partial_cancel.util.BuildPackConfigUtils.logUnexpectedError;</code>
            <code> </code>
            <code>import com.fasterxml.jackson.databind.ObjectMapper;</code>
            <code>import com.mercadolibre.restclient.MeliRestClient;</code>
            <code>import com.mercadolibre.restclient.Response;</code>
            <code>import com.mercadolibre.restclient.exception.RestException;</code>
            <code>import com.mercadolibre.restclient.http.Header;</code>
            <code>import com.mercadolibre.restclient.http.Headers;</code>
            <code>import com.mercadolibre.routing.RoutingHelper;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.dtos.errors.DependencyError;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.exceptions.ResponseParseException;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.exceptions.rest.*;</code>
                    <span class="badge bg-warning text-dark">Using the '.*' form of import should be avoided - com.mercadolibre.shipping_cart_partial_cancel.exceptions.rest.*.</span>
                    <span class="badge bg-warning text-dark">Unused import 'com.mercadolibre.shipping_cart_partial_cancel.exceptions.rest.*'</span>
            <code>import lombok.RequiredArgsConstructor;</code>
            <code>import lombok.extern.slf4j.Slf4j;</code>
            <code>import org.springframework.http.HttpMethod;</code>
            <code>import org.springframework.http.HttpStatus;</code>
            <code>import org.springframework.stereotype.Service;</code>
            <code> </code>
            <code>import java.util.Map;</code>
                    <span class="badge bg-warning text-dark">Extra separation in import group before 'java.util.Map'</span>
                    <span class="badge bg-warning text-dark">Wrong lexicographical order for 'java.util.Map' import. Should be before 'org.springframework.stereotype.Service'.</span>
            <code>import java.util.Optional;</code>
                    <span class="badge bg-warning text-dark">Wrong lexicographical order for 'java.util.Optional' import. Should be before 'org.springframework.stereotype.Service'.</span>
            <code>import java.util.stream.Collectors;</code>
                    <span class="badge bg-warning text-dark">Wrong lexicographical order for 'java.util.stream.Collectors' import. Should be before 'org.springframework.stereotype.Service'.</span>
            <code>import java.util.stream.StreamSupport;</code>
                    <span class="badge bg-warning text-dark">Wrong lexicographical order for 'java.util.stream.StreamSupport' import. Should be before 'org.springframework.stereotype.Service'.</span>
            <code> </code>
            <code>/**</code>
            <code> * Consumes a -MeLi Software System- through an API Rest</code>
            <code> * using Get/Post HTTP Verbs.</code>
            <code> */</code>
            <code>@Service</code>
            <code>@RequiredArgsConstructor</code>
            <code>@Slf4j</code>
            <code>public class RestService {</code>
            <code>    private final MeliRestClient restClient;</code>
                    <span class="badge bg-warning text-dark">'member def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code>    private final ObjectMapper objectMapper;</code>
                    <span class="badge bg-warning text-dark">'member def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    public <T> T get(String poolName, String resource, Class<T> aClass) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
                    <span class="badge bg-warning text-dark">Missing a Javadoc comment.</span>
                    <span class="badge bg-warning text-dark">Parameter name 'aClass' must match pattern '^[a-z]([a-z0-9][a-zA-Z0-9]*)?$'.</span>
            <code>        var ctx = RoutingHelper.getOrCreateMeliContext();</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code>        var apiCallContext = ApiCallContext.<T>builder()</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code>                .responseCaller(() -> restClient.withPool(poolName).get(resource, ctx))</code>
            <code>                .method(HttpMethod.GET)</code>
            <code>                .resource(resource)</code>
            <code>                .headers(this.parseHeaders(ctx.getHeaders()))</code>
            <code>                .body(null)</code>
            <code>                .aClass(aClass)</code>
            <code>                .build();</code>
            <code> </code>
            <code>        return this.callAndParse(apiCallContext);</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    public <T> T post(String poolName, String resource, Object body, Class<T> aClass) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
                    <span class="badge bg-warning text-dark">Missing a Javadoc comment.</span>
                    <span class="badge bg-warning text-dark">Parameter name 'aClass' must match pattern '^[a-z]([a-z0-9][a-zA-Z0-9]*)?$'.</span>
            <code>        var ctx = RoutingHelper.getOrCreateMeliContext();</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code> </code>
            <code>        var apiCallContext = ApiCallContext.<T>builder()</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code>                .responseCaller(() -> restClient.withPool(poolName).post(resource, objectMapper.writeValueAsBytes(body), ctx))</code>
            <code>                .method(HttpMethod.POST)</code>
            <code>                .resource(resource)</code>
            <code>                .headers(this.parseHeaders(ctx.getHeaders()))</code>
            <code>                .body(body)</code>
            <code>                .aClass(aClass)</code>
            <code>                .build();</code>
            <code> </code>
            <code>        return this.callAndParse(apiCallContext);</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    private <T> T callAndParse(ApiCallContext<T> apiCallContext) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code>        try {</code>
                    <span class="badge bg-warning text-dark">'try' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            var response = apiCallContext.getResponseCaller().call();</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code> </code>
            <code>            this.handleErrors(apiCallContext, response);</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code> </code>
            <code>            return objectMapper.readValue(response.getBytes(), apiCallContext.getAClass());</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>        } catch (ApiCallException error) {</code>
                    <span class="badge bg-warning text-dark">'try rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            logUnexpectedError("Doing call and parse", error);</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            throw error;</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>        } catch (RestException e) {</code>
                    <span class="badge bg-warning text-dark">'catch rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            throw new ApiCallException(apiCallContext, HttpStatus.SERVICE_UNAVAILABLE, e.getMessage(), e.getBody());</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
                    <span class="badge bg-warning text-dark">New exception is thrown in catch block, original stack trace may be lost</span>
            <code>        } catch (Exception e) {</code>
                    <span class="badge bg-warning text-dark">'catch rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            throw new ResponseParseException(apiCallContext.getMethod(), apiCallContext.getResource(), e);</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>        }</code>
                    <span class="badge bg-warning text-dark">'catch rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    private void handleErrors(ApiCallContext<?> apiCallContext, Response response) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code>        var httpStatus = HttpStatus.valueOf(response.getStatus());</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code> </code>
            <code>        if(!httpStatus.is2xxSuccessful()) {</code>
                    <span class="badge bg-warning text-dark">'if' has incorrect indentation level 8, expected level should be 4.</span>
                    <span class="badge bg-warning text-dark">'if' is not followed by whitespace.</span>
            <code>            var responseString = response.getString();</code>
                    <span class="badge bg-warning text-dark">'if' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            var message = getErrorMessage(responseString);</code>
                    <span class="badge bg-warning text-dark">'if' child has incorrect indentation level 12, expected level should be 6.</span>
            <code> </code>
            <code>            if (httpStatus.value() == org.apache.http.HttpStatus.SC_BAD_REQUEST) {</code>
                    <span class="badge bg-warning text-dark">'if' has incorrect indentation level 12, expected level should be 6.</span>
            <code>                throw new BadRequestException(apiCallContext, message, responseString);</code>
                    <span class="badge bg-warning text-dark">'if' child has incorrect indentation level 16, expected level should be 8.</span>
            <code>            } else if (httpStatus.value() == org.apache.http.HttpStatus.SC_UNAUTHORIZED) {</code>
                    <span class="badge bg-warning text-dark">'if rcurly' has incorrect indentation level 12, expected level should be 6.</span>
            <code>                throw new UnauthorizedRequestException(apiCallContext, message, responseString);</code>
                    <span class="badge bg-warning text-dark">'if' child has incorrect indentation level 16, expected level should be 8.</span>
            <code>            } else if (httpStatus.value() == org.apache.http.HttpStatus.SC_FORBIDDEN) {</code>
                    <span class="badge bg-warning text-dark">'if rcurly' has incorrect indentation level 12, expected level should be 6.</span>
            <code>                throw new ForbiddenRequestException(apiCallContext, message, responseString);</code>
                    <span class="badge bg-warning text-dark">'if' child has incorrect indentation level 16, expected level should be 8.</span>
            <code>            } else if (httpStatus.is4xxClientError()) {</code>
                    <span class="badge bg-warning text-dark">'if rcurly' has incorrect indentation level 12, expected level should be 6.</span>
            <code>                logUnexpectedError("Handling error", new Error("4xx Client Error"));</code>
                    <span class="badge bg-warning text-dark">'if' child has incorrect indentation level 16, expected level should be 8.</span>
            <code>                throw new DependencyConflictException(apiCallContext, httpStatus, message, responseString);</code>
                    <span class="badge bg-warning text-dark">'if' child has incorrect indentation level 16, expected level should be 8.</span>
            <code>            } else {</code>
                    <span class="badge bg-warning text-dark">'if rcurly' has incorrect indentation level 12, expected level should be 6.</span>
            <code>                throw new ApiCallException(apiCallContext, httpStatus, message, responseString);</code>
                    <span class="badge bg-warning text-dark">'else' child has incorrect indentation level 16, expected level should be 8.</span>
            <code>            }</code>
                    <span class="badge bg-warning text-dark">'else rcurly' has incorrect indentation level 12, expected level should be 6.</span>
            <code>        }</code>
                    <span class="badge bg-warning text-dark">'if rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    /**</code>
            <code>     * Best effort to parse error and get message and status</code>
            <code>     * @param responseString A response in a string to extract the error message</code>
            <code>     * @return A string with the extracted error message</code>
            <code>     */</code>
            <code>    private String getErrorMessage(String responseString) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>        if (responseString == null) {</code>
                    <span class="badge bg-warning text-dark">'if' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            return null;</code>
                    <span class="badge bg-warning text-dark">'if' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>        }</code>
                    <span class="badge bg-warning text-dark">'if rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code> </code>
            <code>        try {</code>
                    <span class="badge bg-warning text-dark">'try' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            return Optional.ofNullable(objectMapper.readValue(responseString, DependencyError.class))</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>                    .filter(dependencyError -> dependencyError.getMessage() != null && dependencyError.getStatus() != null)</code>
            <code>                    .map(dependencyError -> String.format("Dependency error with message [%s] and status [%d]",</code>
            <code>                            dependencyError.getMessage(), dependencyError.getStatus()))</code>
            <code>                    .orElse(responseString);</code>
            <code>        } catch (Throwable e) {</code>
                    <span class="badge bg-warning text-dark">'try rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            log.info("Cannot deserialize error response.", e);</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            return responseString;</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>        }</code>
                    <span class="badge bg-warning text-dark">'catch rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    private Map<String, String> parseHeaders(Headers headers) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code>        return StreamSupport.stream(headers.spliterator(), false)</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code>                .collect(Collectors.toMap(Header::getName, Header::getValue));</code>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code>}</code>
    </pre>
</div>
</body>
</html>