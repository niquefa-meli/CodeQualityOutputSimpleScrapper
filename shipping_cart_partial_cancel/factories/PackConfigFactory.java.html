<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Code Quality Report</title>
    <meta name="description" content="Code Quality Report">
    <meta name="author" content="Quality Tooling Team">

    <!-- CSS only -->
    <link href="/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/resources/bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/resources/prism/prism.css" rel="stylesheet" type="text/css"/>
</head>

<body>
<script src="/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/resources/bootstrap/bootstrap.bundle.min.js" type="text/javascript"></script>
<script src="/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/resources/prism/prism.js"></script>

<div class="container">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/root.html>root</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/src.html>src</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/main.html>main</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/java.html>java</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/com.html>com</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/mercadolibre/mercadolibre.html>mercadolibre</a></li>
                    <li class="breadcrumb-item"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/mercadolibre/shipping_cart_partial_cancel/shipping_cart_partial_cancel.html>shipping_cart_partial_cancel</a></li>
                    <li class="breadcrumb-item active" aria-current="page"><a href=/Users/rniquefa/fury_shipping-cart-partial-cancel/code_quality_service/src/main/java/com/mercadolibre/shipping_cart_partial_cancel/factories/factories.html>factories</a></li>
        </ol>
    </nav>
</div>

<div class="container">
    <h2>PackConfigFactory.java</h2>
    <span class="badge bg-warning text-dark">Total issues: 43</span>
    <span class="badge bg-warning text-dark">Complexity: 9</span>
    <hr>
</div>

<div class="container">
    <pre class="language-java line-numbers">
            <code>package com.mercadolibre.shipping_cart_partial_cancel.factories;</code>
                    <span class="badge bg-warning text-dark">Package name 'com.mercadolibre.shipping_cart_partial_cancel.factories' must match pattern '^[a-z]+(\.[a-z][a-z0-9]*)*$'.</span>
            <code> </code>
            <code>import static com.mercadolibre.shipping_cart_partial_cancel.constants.Source.PARTIAL_CANCELLATION;</code>
            <code>import static com.mercadolibre.shipping_cart_partial_cancel.constants.Tags.SOURCE_PARTIAL_CANCELLATION;</code>
            <code>import static com.mercadolibre.shipping_cart_partial_cancel.util.BuildPackConfigUtils.logUnexpectedError;</code>
            <code> </code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.dtos.output.PackConfig;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.dtos.output.PackConfig.Shipment;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.dtos.output.TrashPackConfig;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.dtos.output.TrashPackConfig.ShippingOption;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.dtos.process.CalculatorSnapshot;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.dtos.process.Snapshot;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.exceptions.InvalidOptionException;</code>
            <code>import com.mercadolibre.shipping_cart_partial_cancel.util.BuildPackConfigUtils;</code>
            <code>import lombok.extern.log4j.Log4j2;</code>
            <code>import org.apache.commons.lang3.tuple.Pair;</code>
            <code>import org.springframework.stereotype.Service;</code>
            <code> </code>
            <code>import java.util.List;</code>
                    <span class="badge bg-warning text-dark">Extra separation in import group before 'java.util.List'</span>
                    <span class="badge bg-warning text-dark">Wrong lexicographical order for 'java.util.List' import. Should be before 'org.springframework.stereotype.Service'.</span>
            <code> </code>
            <code>/**</code>
            <code> * Utility class to build the pack configs.</code>
            <code> */</code>
            <code>@Log4j2</code>
            <code>@Service</code>
            <code>public class PackConfigFactory {</code>
            <code> </code>
            <code>    private static final String BUILD_PACK_ERROR = "Building pack config with snapshot: %s and addressId: %s";</code>
                    <span class="badge bg-warning text-dark">'member def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code></code>
            <code>    /**</code>
            <code>     * Given a snapshot, looks for every config (Pack) and if any</code>
            <code>     * of his options matches with optionHash returns</code>
            <code>     * the pack which contains it.</code>
            <code>     * @param snapshot snapshot to look into</code>
            <code>     * @param optionHash item to search</code>
            <code>     * @param addressId pack shipment address id</code>
            <code>     * @return {@link PackConfig}</code>
            <code>     * @see PackConfig</code>
            <code>     */</code>
            <code>    public PackConfig buildPackConfig(Snapshot snapshot, String optionHash, long addressId) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>        try {</code>
                    <span class="badge bg-warning text-dark">'try' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            return snapshot.getRawData().getShippingConfigs().stream()</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>                    .flatMap(shippingConfig -> shippingConfig.getOptions().stream().map(option -> Pair.of(shippingConfig, option)))</code>
            <code>                    .filter(tuple -> tuple.getRight().getOptionHash().equals(optionHash))</code>
            <code>                    .findAny()</code>
            <code>                    .map(tuple -> {</code>
            <code>                        var rawData = snapshot.getRawData();</code>
                    <span class="badge bg-warning text-dark">'block' child has incorrect indentation level 24, expected level should be 22.</span>
            <code>                        var destination = this.adaptToPackDestination(addressId, rawData.getDestination());</code>
                    <span class="badge bg-warning text-dark">'block' child has incorrect indentation level 24, expected level should be 22.</span>
            <code> </code>
            <code>                        return PackConfig.builder()</code>
                    <span class="badge bg-warning text-dark">'block' child has incorrect indentation level 24, expected level should be 22.</span>
            <code>                                .shipment(Shipment.builder()</code>
            <code>                                        .snapshotId(snapshot.getSnapshotId())</code>
            <code>                                        .destination(destination)</code>
            <code>                                        .dimensions(tuple.getLeft().getDimensions())</code>
            <code>                                        .buyer(BuildPackConfigUtils.getBuyerInSnapshot(snapshot))</code>
            <code>                                        .shippingOption(tuple.getRight())</code>
            <code>                                        .tags(List.of(SOURCE_PARTIAL_CANCELLATION))</code>
            <code>                                        .build())</code>
            <code>                                .build();</code>
            <code>                    })</code>
            <code>                    .orElseThrow(() -> new InvalidOptionException(snapshot.getSnapshotId(), optionHash));</code>
            <code>        } catch (Throwable error) {</code>
                    <span class="badge bg-warning text-dark">'try rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            logUnexpectedError(String.format(BUILD_PACK_ERROR, snapshot.getSnapshotId(), addressId)</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>                    + ", optionHash:" + optionHash, error);</code>
            <code>            throw error;</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>        }</code>
                    <span class="badge bg-warning text-dark">'catch rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    /**</code>
            <code>     * Get pack from a snapshot which has only one pack</code>
            <code>     * and this only one option.</code>
            <code>     * @param snapshot snapshot to look into</code>
            <code>     * @param addressId pack shipment address id</code>
            <code>     * @param shipmentId the shipment id, if the shipment was already created</code>
            <code>     * @param shipmentCreated if the shipment was already created</code>
            <code>     * @return {@link PackConfig}</code>
            <code>     * @see PackConfig</code>
            <code>     */</code>
            <code>    public PackConfig buildPackConfig(CalculatorSnapshot snapshot, long addressId, long shipmentId, boolean shipmentCreated) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code>        try {</code>
                    <span class="badge bg-warning text-dark">'try' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            var shippingConfig = snapshot.getShippingConfigs().get(0);</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            var destination = this.adaptToPackDestination(addressId, snapshot.getDestination());</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code> </code>
            <code>            return PackConfig.builder()</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>                    .shipment(Shipment.builder()</code>
            <code>                            .snapshotId(snapshot.getSnapshotId())</code>
            <code>                            .buyer(snapshot.getBuyer())</code>
            <code>                            .dimensions(shippingConfig.getDimensions())</code>
            <code>                            .shippingOption(shippingConfig.getOptions().get(0))</code>
            <code>                            .destination(destination)</code>
            <code>                            .tags(List.of(SOURCE_PARTIAL_CANCELLATION))</code>
            <code>                            .shippingSibling(this.buildShippingSibling(shipmentId, shipmentCreated))</code>
            <code>                            .build())</code>
            <code>                    .build();</code>
            <code>        } catch (Throwable error) {</code>
                    <span class="badge bg-warning text-dark">'try rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            logUnexpectedError(String.format(BUILD_PACK_ERROR, snapshot.getSnapshotId(), addressId), error);</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            throw error;</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>        }</code>
                    <span class="badge bg-warning text-dark">'catch rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    /**</code>
            <code>     * Given a packConfig which is the old version of newPackConfig</code>
            <code>     * builds a TrashPackConfig to keep a trace of changes.</code>
            <code>     * @param packConfig old version</code>
            <code>     * @param newPackConfig new pack</code>
            <code>     * @return {@link TrashPackConfig}</code>
            <code>     * @see TrashPackConfig</code>
            <code>     */</code>
            <code>    public TrashPackConfig buildTrashPackConfig(PackConfig packConfig, PackConfig newPackConfig) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code>        try {</code>
                    <span class="badge bg-warning text-dark">'try' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            var shipment = packConfig.getShipment();</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            var option = shipment.getShippingOption();</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            var newOption = newPackConfig.getShipment().getShippingOption();</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            var cost = option.getCost().subtract(newOption.getCost());</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code> </code>
            <code>            return TrashPackConfig.builder()</code>
                    <span class="badge bg-warning text-dark">'try' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>                    .shipment(TrashPackConfig.Shipment.builder()</code>
            <code>                            .snapshotId(shipment.getSnapshotId())</code>
            <code>                            .shippingOption(ShippingOption.builder()</code>
            <code>                                    .cost(cost)</code>
            <code>                                    .optionHash(option.getOptionHash())</code>
            <code>                                    .build())</code>
            <code>                            .build())</code>
            <code>                    .build();</code>
            <code>        } catch (Throwable error) {</code>
                    <span class="badge bg-warning text-dark">'try rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>            logUnexpectedError("Building trash pack config", error);</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>            throw error;</code>
                    <span class="badge bg-warning text-dark">'catch' child has incorrect indentation level 12, expected level should be 6.</span>
            <code>        }</code>
                    <span class="badge bg-warning text-dark">'catch rcurly' has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    private PackConfig.Destination adaptToPackDestination(long addressId, Snapshot.Destination destination) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code>        return new PackConfig.Destination(destination.getZipCode(), destination.getCity().getId(), addressId);</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code> </code>
            <code>    private PackConfig.ShippingSibling buildShippingSibling(long shipmentId, boolean shipmentCreated) {</code>
                    <span class="badge bg-warning text-dark">'method def modifier' has incorrect indentation level 4, expected level should be 2.</span>
            <code>        return shipmentCreated ? PackConfig.ShippingSibling.builder().siblingId(shipmentId).source(PARTIAL_CANCELLATION).build() : null;</code>
                    <span class="badge bg-warning text-dark">'method def' child has incorrect indentation level 8, expected level should be 4.</span>
            <code>    }</code>
                    <span class="badge bg-warning text-dark">'method def rcurly' has incorrect indentation level 4, expected level should be 2.</span>
            <code>}</code>
    </pre>
</div>
</body>
</html>